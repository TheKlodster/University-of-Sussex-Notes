# Malware: Viruses & Worms

## Classification of Malware
Two broad categories:
- Propagation
- Payload

## Types of Malware
**Propagation** mechanisms include:
- viruses.
- worms.
- social engineering attacks:
  - pishing links.
  - fake emails.
  - harrassing calls.

**Payload** actions can include:
- corruption of system or data files.
- theft of service.
- theft of information.
- hiding its presence on the system.

## Attack Kits
The development and deployment of malware required considerable technical skill by software authors. Toolkits are often known as *crimeware*.

Attack kits include propagation & payload modules.

Examples:
- Zeus
- Angler

## Advanced Persistent Threats (APTs)
Persistent application of intrusion technologies and malware to selected targets.
- Usually business or political.

These attacks differ from others due to their target selection and stealthy intrusion efforts.

High profile attacks include:
- Aurora
- RSA
- APT1
- Stuxnet

### Characteristics
- **Advanced**
  - attackers using a variety of intrusion technologies, possibly custom developed malware.
- **Persistent**
  - determined attack over an extended period of time against the target.
  - attacks continue until target is compromised.
- **Threats**
  - blackmail.
  - 

## Viruses
Piece of software that infects programs.
- modifies them to include a copy of the virus.
- replicates and goes on to infect other content.
- easily spread through network environments.

Can be attacted to a <code>.exe</code>, and do anything that program is permitted to do.
- executes secretly when the host program is run.

Specific to OS and hardware.
- takes advantage of their details & weaknesses.

*Macro viruses* infect scripting code used to support active content in a variety of user document types.

## Virus components
- **Infection mechanism**
  - means by which a virus spreads, also know as *infection vector*.
- **Trigger**
  - condition that determines when the payload is activated/delivered, also known as *logic bomb*.
- **Payload**
  - what the virus does.
  - may involve damage.

### Virus phases
1. Dormant phase.
    - virus is idle, awaiting activation.
2. Triggering phase.
    - virus places a copy of itself into other programs or certain areas on the disk.
3. Propagation phase.
    - virus is activated!
4. Execution phase.
    - function is performed; may be harmless or damaging, such as a message or destruction of programs/files!

### Virus classification
<center>

| Classification by target | Classification by concealment strategy |
|--------------------------|----------------------------------------|
| - Boot sector infector.  | - Encrypted virus.                     |
| - File infector.         | - Stealth virus.                       |
| - Macro virus.           | - Polymorphic virus.                   |
| - Multipartile virus.    | - Metamorphic virus.                   |

</center>

## Worms
Programs that actively seek out more machines to infect and each infected machine serves as an automated launching pad for attacks on other machines.

Worms:
- exploit software vulnerabilities.
- can use network connections to spread.
- spread through shared media (USB drives, CD, DVDs etc...).
- spread in email through macro or script code included in attachments.
- usually carry some form of payload.

### Worm replication
- **Email or messenger**
  - worm emails a copy of itself to other systems.
- **File sharing**
  - creates a copy of itself or infects a file as a virus on removable media.
- **Remote execution capability**
  - worm executes a copy of itself on another system.
- **Remote file access or transfer capability**
  - worm uses a remote file access or transfer service to copy itself from one system to another.
- **Remote login capability**
  - worm logs onto a remote system as a user then uses commands to copy itself from on system to the other.

*Target Discovery slide?*

## Mobile Code

*Programs that can be shipped unchanged to a collection of platforms and executed with identical semantics.*

- Transmitted from a remote system to a local system; executed on the local system.
- Acts as a mechanism for a virus, worm or Trojan horse.

Popular vehicles include:
- Java applets,
- ActiveX.
- Javascript.
- VBScript.

Common mobile code malicious operations:
- Cross-site scripting.
- Interactive & dynamic web sites.
- Email attachments.
- Downloads from untrusted sites/software.

### Mobile Phone Worms
Communication through bluetooth wireless connections or MMS - target is the smartphone.
- Can completely disable the phone, delete the data on the phone, or force the device to send costly messages.

## Drive-by-downloads
- Exploits browser & plugin so when the user view a controlled webpage, it contains code that exploits bugs to download & install malware on the system without the user's knowledge.
- In most cases, malware does not actively propagate as a worm does.
- Spreads when users vists the malicious web page.

## Watering-Hole Attacks
A variant of the **Drive-by-downloads**.
- Attack identifies common websites that the target visits.
- Researches how to infect the website, specifically only for the target so other visitors and unharmed.
- Site compromise remains undetected.

## Malvertising
Placing malwares in advertising, not actually compromising the website.

## Clickjacking (User-interface redress attack)
Keystrokes can also be hijacked.
- user can be led to believe they are typing their username and password, but are instead typing into an invisible frame controlled by the attacker.
- by taking advantage of Adobe Flash/JavaSCript, an attacker can place button overlays over legitimate buttons.
- highjack licks meant for one page and routing them to another page.

## Ransomware
Encrypt data, asking the target to pay a ransom, or to make a purchase from certain sites, in order to decrypt this data.

## Payload

### Attack Agents Bots
Takes over another internet attached computer and uses that computer to launch/manage attacks. <br>
**Botnet** - collection of bots capable of acting in a coordinate manner. <br>
Uses:
- DDoS.
- Spamming.
- Sniffing traffic.
- Keylogging.
- Spreading new malware.
- Installing advertisement add-ons and browser helper objects (BHOs).
- Attacking Internet Chat Relay (IRC) chat networks.
- Manipulating online polls/games.

Bots are remotely controlled.
- bots join a specific channel on the server and cheat incoming messages as commands.
- recent botnets use protocls such as HTTP to communicate through.
- others uses a peer-to-peer protocol to avoid a single point of failure.

### Information Theft Keyloggers & Spyware
**Keylogger**
- Captures keystrokes to allow attacker to monitor sensitive information.
- Typically uses some form of filtering mechanism that only returns information close to keywords (“login”, “password”).

**Spyware**
- Controls the compromised machine to allow monitoring of activity on the system.
    - Monitoring history and browsing activity.
    - Redirecting certain web page requests to fake sites.
    - Modifying data exhcnaged between the browser and certain websites of interest.

### Information Theft Phishing
Exploits social engineering the gain the user's trust by pretending to be a good source.
- Suggests that urgent action is required by the user to authenticate their account.
- Include a URL in an email that links to a fake website, mimicing the real version of those websites.
  - banking, gaming etc...

Spear-phishing
- Recipients are carefully researched by the attacker.
- Email is crafted to specifically suit its recipient, often quoting a range of information to convince them of its authenticity.

### Stealthing Backdoor (*trapdoor*)
Secret entry point into a program allowing the attacker to gain access and bypass the security access procedures.
- *Maintenacne hook* is a backdoor used by Programmers to debug and test programs.
- Difficult to implement operating system controls for backdoors in applications.

### Stealthing Rootkit
Set of hidden programs installed on a system to maintain covert access to that system.
- Hides by controlling the mechanisms that monitor and report on the processes, files, and registries on a computer.
- Gives root privileges to attacker.
  - Can add or change programs and files, monitor processes, send and receive network traffic, and get backdoor access on demand.

## Rootkid Classification Characteristics
1. Persistent
2. Memory based
3. User mode
4. Kernal mode
5. Virtual Based machine
6. External mode

<center>

<img src="https://slideplayer.com/slide/12293218/72/images/44/Payload+-+Stealthing+Rootkit.jpg">

</center>

## Malware Countermeasure approaches
Four main elements of prevention:
1. Policy
2. Awareness 
3. Vulnerability mitigation
4. Threat mitigation

If prevention fails, we can support through:
- Detection
- Identification
- Removal

### Requirements for effective malware countermeasures
- **Generality**: to handle a wide variety of attacks.
- **Timeliness**: respond quickly so as to limit the number of infected programs or systems and the consequent activity.
- **Resiliency**: resistant to evasion techniques employed by attackers to hide the presence of their malware.
- **Minimal denial-of-service-costs**: minimal reduction in capacity or service due to the actions of the countermeasure software and should not significantly disrupt normal operation.
- **Transparency**: not require modification to existing (legacy) OSs, application software, and hardware.
- **Global and local coverage**: deal with attack sources both from outside and inside the enterprise network.

## Generations of Anti-Virus software
1. **First Generation**: Simple scanners.
2. **Second Generation**: heuristic scanners.
3. **Third Generation**: activity traps.
4. **Fourth Generation**: full-featured protection.

There's also **Sandbox Analysis** where we can run potential malicious code in a VM.

*Maybe slides 25 & 26 on Lecture 2b?*